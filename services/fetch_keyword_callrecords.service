[Unit]
Description=Fetch Keywords from call records
After=network.target

[Service]
Type=simple
ExecStart=/bin/bash -c 'log_file="/root/answering-machine-detection/src/keyword_update/log/llm-$(date +%%Y-%%m-%%d-%%H).txt" && source /root/.bashrc && /root/venv/bin/python /root/answering-machine-detection/src/keyword_update/keyword_extractor_llama.py >> "$log_file" 2>&1

# wait 2 minutes to keyword_extractor starts
sleep 120

ExecStart=/bin/bash -c 'log_file="/root/answering-machine-detection/src/keyword_update/log/kwe-$(date +%%Y-%%m-%%d-%%H).txt" && source /root/.bashrc && /root/venv/bin/python /root/answering-machine-detection/src/keyword_update/fetch_keywords.py --domain "127.0.0.1" --port "8000" > "$log_file" 2>&1'
RestartSec=3
Environment="PATH=/usr/local/bin:/usr/bin"
StandardOutput=journal
RemainAfterExit=false
User=root
